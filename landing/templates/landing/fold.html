{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Folders</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link rel="stylesheet" href="{% static 'css/style.css' %}">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet">
  <style>
    body {
      margin: 0;
      font-family: 'Segoe UI', sans-serif;
      display: flex;
      height: 100vh;
    }

    .sidebar {
      width: 240px;
      background-color: #fff5dd;
      padding: 20px;
      display: flex;
      flex-direction: column;
      border-right: 1px solid #ccc;
    }
    .sidebar .logo {
      text-align: center;
      margin-bottom: 30px;
    }
    .sidebar .logo img {
      width: 100px;
    }
    .sidebar ul {
      list-style: none;
    }
    .sidebar ul li {
      padding: 15px;
      color: #222;
      font-weight: 600;
      cursor: pointer;
      border-left: 5px solid transparent;
    }
    .sidebar ul li.active,
    .sidebar ul li:hover {
      background-color: #f2e9c9;
      border-left: 5px solid #d8b400;
    }

    .sidebar a {
      text-decoration: none;
      color: #003366;
      padding: 15px 20px;
      width: 100%;
      text-align: left;
      transition: 0.3s;
      font-weight: 500;
    }

 

    .active {
      background-color: #dcc990;
      border-left: 4px solid red;
    }

    .main-content {
      flex: 1;
      background-color: #f4f4f4;
      padding: 20px 30px;
      overflow-y: auto;
      background: url('/static/images/background.jpg') no-repeat center center fixed;
      background-size: cover;
      position: relative;
    }
    .main-content::before {
  content: "";
  position: absolute;
  top: 0; left: 0; right: 0; bottom: 0;
  
  z-index: 0;
}
.main-content > * {
  position: relative;
  z-index: 1;
}
    

    .top-bar {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 90px;
      margin-top: 50px;
    }

    .top-left-buttons button {
      background-color: white;
      color: black;
      padding: 8px 16px;
      border: none;
      margin-right: 10px;
      border-radius: 6px;
      font-weight: 600;
      cursor: pointer;
    }

    .search-box {
      padding: 8px 12px;
      border: 1px solid #ccc;
      border-radius: 5px;
      width: 250px;
      outline: none;
    }

    .folders-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
      gap: 20px;
      margin-top: 10px;
    }

    .folder {
      background-color: #e0c153;
      border-radius: 8px;
      padding: 15px;
      color: #000;
      font-weight: 500;
      display: flex;
      align-items: center;
      gap: 10px;
      box-shadow: 2px 2px 8px rgba(0,0,0,0.2);
      cursor: pointer;
      transition: 0.2s;
      width: 120px;
      height:40px;
      
    }

    .folder:hover {
      background-color: #e1c874;
      transform: scale(1.05);
    }
    .folders-grid {
  display: flex;
  flex-wrap: wrap;
  gap: 20px;
  margin: 20px 0;
}

    .upload-form {
      background-color: white;
      padding: 20px;
      border-radius: 10px;
      margin-bottom: 30px;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
    }

    .file-list {
      background-color: white;
      padding: 20px;
      border-radius: 10px;
      margin-top: 20px;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
    }

    .file-list ul {
      list-style: none;
      padding: 0;
    }

    .file-list li {
      margin-bottom: 10px;
    }
    .create-folder-form {
    margin-top: 10px;
    display: none;
    padding: 15px;
    background-color: #fff3cd;
    border: 1px solid #ffeeba;
    border-radius: 8px;
    box-shadow: 2px 2px 5px rgba(0,0,0,0.1);
  }

  .create-folder-form input[type="text"] {
    padding: 8px;
    border: 1px solid #ccc;
    border-radius: 4px;
    width: 250px;
    margin-right: 10px;
  }

  .create-folder-form button {
    padding: 8px 14px;
    background-color: #ffc107;
    border: none;
    border-radius: 4px;
    cursor: pointer;
    font-weight: 600;
    color: black;
  }

  .create-folder-form button:hover {
    background-color: #e0a800;
  }
  .uploaded-file a {
  text-decoration: none;
  color: #212529; /* dark text */
  font-weight: 500;
}
.uploaded-file a:hover {
  text-decoration: underline;
}

  </style>
</head>

<!-- âœ… Add SweetAlert2 CDN before </head> -->
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

<body>

  <div class="sidebar">
    <img src="{% static 'images/DILG-Logo.png' %}" alt="DILG Logo" class="sidebar-logo" />
  
    <ul>
      <li>
        <a href="{% url 'landing:fold' %}" class="{% if request.resolver_match.url_name == 'folds' %}active{% endif %}">
          Folders
        </a>
      </li>
    </ul>
  </div>

  <div class="main-content">
    <div style="display: flex; justify-content: flex-end; align-items: center; gap: 15px; margin: 10px 20px;">
      <img src="{% static 'images/notif.png' %}" alt="Notifications" style="width: 24px; height: 24px; cursor: pointer;"/>
      <img src="{% static 'images/menu.png' %}" alt="Menu" style="width: 24px; height: 24px; cursor: pointer;"/>
    
    </div>
    <div class="top-bar">
      <div class="top-left-buttons">
        <button onclick="toggleCreateFolderForm()"><i class="fas fa-plus"></i> Create</button>
        <button onclick="document.getElementById('fileInput').click();"><i class="fas fa-upload"></i> Upload</button>
      </div>
      
      <!-- Hidden Upload Form -->
      <form id="uploadForm" method="post" enctype="multipart/form-data" style="display: none;">
        {% csrf_token %}
        <input type="file" id="fileInput" name="file" onchange="document.getElementById('uploadForm').submit();" />
      </form>
      
      <!-- Create Folder Form -->
      <form id="createFolderForm" class="create-folder-form" method="post" style="display: none;">
        {% csrf_token %}
        <input type="text" name="new_folder" id="newFolderNameInput" placeholder="Enter folder name" required />
        <button type="submit">Create Folder</button>
      </form>

      <input class="search-box" type="text" placeholder="Search...">
    </div>

    <!-- Folder grid -->
    <div class="folders-grid">
      {% for folder in folders %}
        <a href="{% url 'landing:folder_detail' folder.name %}">
          <div class="folder">
            <i class="fa fa-folder"></i> {{ folder.name }}
          </div>
        </a>
      {% endfor %}
    </div>

    {% if selected_folder %}
      <h3>Viewing files in folder: <strong>{{ selected_folder }}</strong></h3>
    {% endif %}

    <!-- Uploaded files list -->
    <div class="file-list p-4">
      <h3 class="text-center font-semibold text-lg mb-4">Uploaded Files</h3>
      <ul class="space-y-3">
        {% for file in files %}
          <li class="flex justify-between items-center bg-white border border-gray-200 rounded-lg px-5 py-3 shadow-sm hover:shadow-md transition-all">
            <!-- File name (left) -->
            <div class="text-gray-800 font-medium truncate w-2/3">
              {{ file.file.name|cut:"documents/" }}
            </div>

            <!-- Delete form (right) -->
            <form id="delete-form-{{ file.id }}" method="post" action="{% url 'landing:delete_file' file.id %}">
              {% csrf_token %}
              <button type="button"
                onclick="confirmDelete('{{ file.id }}')"
                class="bg-gradient-to-r from-red-500 to-red-600 hover:from-red-600 hover:to-red-700 text-white font-semibold px-4 py-2 rounded-md shadow transition duration-200 ease-in-out">
                <i class="fas fa-trash-alt mr-2"></i> Delete
              </button>
            </form>
          </li>
        {% endfor %}
      </ul>
    </div>
  </div>

  <!-- Toggle JS -->
  <script>
    function toggleCreateFolderForm() {
      const form = document.getElementById('createFolderForm');
      form.style.display = (form.style.display === 'none' || form.style.display === '') ? 'block' : 'none';
      document.getElementById('newFolderNameInput').focus();
    }
  </script>

<script>
  function confirmDelete(fileId) {
    Swal.fire({
      title: 'Are you sure?',
      text: "This file will be permanently deleted.",
      icon: 'warning',
      showCancelButton: true,
      confirmButtonColor: '#d33',
      cancelButtonColor: '#3085d6',
      confirmButtonText: 'Yes, delete it!',
      reverseButtons: true
    }).then((result) => {
      if (result.isConfirmed) {
        document.getElementById(`delete-form-${fileId}`).submit();
      }
    });
  }
</script>
  


</body>
</html>